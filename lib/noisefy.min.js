!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("noisefy",[],t):"object"==typeof exports?exports.noisefy=t():e.noisefy=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._audioContext=t}var t,n,r;return t=e,(n=[{key:"connect",value:function(t){return t instanceof e?this.node.connect(t.node):this.node.connect(t),t}},{key:"disconnect",value:function(){return this.node.disconnect(),this.node}},{key:"destroy",value:function(){return this.disconnect()}},{key:"audioContext",get:function(){return this._audioContext},set:function(e){this._audioContext=e}},{key:"node",get:function(){return this._node},set:function(e){this._node=e}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(0))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,r.default),n=t,(o=[{key:"connect",value:function(e){return e instanceof r.default||e instanceof t?this.node.connect(e.node):this.node.connect(e),e}},{key:"disconnect",value:function(){return this.output.disconnect(),this.output}},{key:"destroy",value:function(){var e=this;return Object.keys(this.nodes).forEach(function(t){e.nodes[t].disconnect&&"function"==typeof e.nodes[t].disconnect&&e.nodes[t].disconnect()}),this.disconnect()}},{key:"output",get:function(){return this._outputNode},set:function(e){this._outputNode=e}}])&&u(n.prototype,o),i&&u(n,i),t}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.hasAudioContext=t.hasGetUserMedia=void 0;var n="undefined"!=typeof window?window:e,o=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia);t.hasGetUserMedia=o;var r=!!(n.AudioContext||n.webkitAudioContext||n.mozAudioContext||n.msAudioContext);t.hasAudioContext=r}).call(this,n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Input",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Output",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Volume",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Reverb",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"hasAudioContext",{enumerable:!0,get:function(){return c.hasAudioContext}}),Object.defineProperty(t,"hasGetUserMedia",{enumerable:!0,get:function(){return c.hasGetUserMedia}});var o=f(n(4)),r=f(n(6)),i=f(n(7)),u=f(n(8)),c=n(2);function f(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(0)),r=u(n(1)),i=n(2);function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)))._deferredConnects=[],n._hasPermissions=!1,n}var n,u,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,o.default),n=t,(u=[{key:"getUserMedia",value:function(){var e=this;return new Promise(function(t,n){i.hasGetUserMedia?navigator.getUserMedia({audio:!0},function(n){e.input=n,e._hasPermissions=!0,e._deferredConnects.forEach(function(t){e.connect(t)}),t(n)},function(e){n(e)}):n(Error("Your browser does not support the use of user-media, please upgrade or use another browser!"))})}},{key:"connect",value:function(e){return void 0===this.node?(this._deferredConnects.push(e),e):(e instanceof o.default||e instanceof r.default?this.node.connect(e.node):this.node.connect(e),this.node.connect(e),e)}},{key:"getAudioDevices",value:function(){var e=this;return new Promise(function(t,n){e._hasPermissions?navigator.mediaDevices.enumerateDevices().then(function(e){t(e.filter(function(e){return e.kind&&"audioinput"===e.kind}))}).catch(function(e){n(e)}):e.getUserMedia().then(function(){navigator.mediaDevices.enumerateDevices().then(function(e){t(e.filter(function(e){return e.kind&&"audioinput"===e.kind}))}).catch(function(e){n(e)})}).catch(function(e){n(e)})})}},{key:"input",get:function(){return this.node},set:function(e){this.node=this.audioContext.createMediaStreamSource(e)}}])&&f(n.prototype,u),c&&f(n,c),t}();t.default=l,e.exports=t.default},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(0))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))).audioContext&&(n.node=e.destination),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,r.default),t}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(0))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))).node=n.audioContext.createGain(),n.level=1,n.mute=!1,n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,r.default),n=t,(o=[{key:"level",get:function(){return this._level},set:function(e){var t=parseFloat(e);t=t>=0?t:0,this._level=t,this.node.gain.value=t,this._mute=0===t}},{key:"mute",get:function(){return this._mute},set:function(e){this._mute=!!e,this._mute?(this._levelBeforeMute=this.level,this.level=0):this.level=this._levelBeforeMute||this._level}}])&&u(n.prototype,o),i&&u(n,i),t}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(1))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))).nodes={inputGainNode:e.createGain(),outputGainNode:e.createGain(),convolverNode:e.createConvolver(),wetGainNode:e.createGain(),levelGainNode:e.createGain()},o.nodes.inputGainNode.connect(o.nodes.convolverNode),o.nodes.inputGainNode.connect(o.nodes.wetGainNode),o.nodes.convolverNode.connect(o.nodes.levelGainNode),o.nodes.levelGainNode.connect(o.nodes.outputGainNode),o.nodes.wetGainNode.connect(o.nodes.outputGainNode),o.node=o.nodes.inputGainNode,o.output=o.nodes.outputGainNode,o.wet=.5,o.level=1,o}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,r.default),n=t,(o=[{key:"getInputResponseFile",value:function(e){return fetch(e,{method:"get"}).then(function(e){return e.arrayBuffer()})}},{key:"wet",get:function(){return this._wet},set:function(e){this._wet=parseFloat(e),this.nodes.wetGainNode.gain.value=this._wet}},{key:"level",get:function(){return this._level},set:function(e){this._level=parseFloat(e),this.nodes.levelGainNode.gain.value=this._level}},{key:"buffer",get:function(){return this._buffer},set:function(e){var t=this;this.audioContext.decodeAudioData(e,function(e){t._buffer=e,t.nodes.convolverNode.buffer=t._buffer})}}])&&u(n.prototype,o),i&&u(n,i),t}();t.default=a,e.exports=t.default}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub2lzZWZ5L3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9ub2lzZWZ5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL25vaXNlZnkvLi9zcmMvYXVkaW8tbm9kZXMvU2luZ2xlQXVkaW9Ob2RlLmpzIiwid2VicGFjazovL25vaXNlZnkvLi9zcmMvYXVkaW8tbm9kZXMvTXVsdGlBdWRpb05vZGUuanMiLCJ3ZWJwYWNrOi8vbm9pc2VmeS8uL3NyYy9VdGlsLmpzIiwid2VicGFjazovL25vaXNlZnkvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbm9pc2VmeS8uL3NyYy9hdWRpby1ub2Rlcy9lZmZlY3RzL0lucHV0LmpzIiwid2VicGFjazovL25vaXNlZnkvKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovL25vaXNlZnkvLi9zcmMvYXVkaW8tbm9kZXMvZWZmZWN0cy9PdXRwdXQuanMiLCJ3ZWJwYWNrOi8vbm9pc2VmeS8uL3NyYy9hdWRpby1ub2Rlcy9lZmZlY3RzL1ZvbHVtZS5qcyIsIndlYnBhY2s6Ly9ub2lzZWZ5Ly4vc3JjL2F1ZGlvLW5vZGVzL2VmZmVjdHMvUmV2ZXJiLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInNlbGYiLCJ0aGlzIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlNpbmdsZUF1ZGlvTm9kZSIsImF1ZGlvQ29udGV4dCIsIl9jbGFzc0NhbGxDaGVjayIsIl9hdWRpb0NvbnRleHQiLCJub2RlIiwiY29ubmVjdCIsImRpc2Nvbm5lY3QiLCJfbm9kZSIsIl9TaW5nbGVBdWRpb05vZGUyIiwiTXVsdGlBdWRpb05vZGUiLCJkZWZhdWx0Iiwib3V0cHV0IiwiX3RoaXMiLCJrZXlzIiwibm9kZXMiLCJmb3JFYWNoIiwiX291dHB1dE5vZGUiLCJ3aW4iLCJ3aW5kb3ciLCJnbG9iYWwiLCJoYXNHZXRVc2VyTWVkaWEiLCJuYXZpZ2F0b3IiLCJnZXRVc2VyTWVkaWEiLCJ3ZWJraXRHZXRVc2VyTWVkaWEiLCJtb3pHZXRVc2VyTWVkaWEiLCJtc0dldFVzZXJNZWRpYSIsImhhc0F1ZGlvQ29udGV4dCIsIkF1ZGlvQ29udGV4dCIsIndlYmtpdEF1ZGlvQ29udGV4dCIsIm1vekF1ZGlvQ29udGV4dCIsIm1zQXVkaW9Db250ZXh0IiwiX0lucHV0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9PdXRwdXQiLCJfVm9sdW1lIiwiX1JldmVyYiIsIl9VdGlsIiwiX011bHRpQXVkaW9Ob2RlIiwiSW5wdXQiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsIl9fcHJvdG9fXyIsImdldFByb3RvdHlwZU9mIiwiX2RlZmVycmVkQ29ubmVjdHMiLCJfaGFzUGVybWlzc2lvbnMiLCJfdGhpczIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImF1ZGlvIiwic3RyZWFtIiwiaW5wdXQiLCJlcnJvciIsIkVycm9yIiwicHVzaCIsIl90aGlzMyIsIm1lZGlhRGV2aWNlcyIsImVudW1lcmF0ZURldmljZXMiLCJ0aGVuIiwiZGV2aWNlcyIsImZpbHRlciIsImRldmljZSIsImtpbmQiLCJjYXRjaCIsImNyZWF0ZU1lZGlhU3RyZWFtU291cmNlIiwiZyIsIkZ1bmN0aW9uIiwiZSIsIk91dHB1dCIsImRlc3RpbmF0aW9uIiwiVm9sdW1lIiwiY3JlYXRlR2FpbiIsImxldmVsIiwibXV0ZSIsIl9sZXZlbCIsInZvbHVtZSIsInZvbCIsInBhcnNlRmxvYXQiLCJnYWluIiwiX211dGUiLCJfbGV2ZWxCZWZvcmVNdXRlIiwiX011bHRpQXVkaW9Ob2RlMiIsIlJldmVyYiIsImJ1ZmZlciIsImlucHV0R2Fpbk5vZGUiLCJvdXRwdXRHYWluTm9kZSIsImNvbnZvbHZlck5vZGUiLCJjcmVhdGVDb252b2x2ZXIiLCJ3ZXRHYWluTm9kZSIsImxldmVsR2Fpbk5vZGUiLCJ3ZXQiLCJmaWxlIiwiZmV0Y2giLCJtZXRob2QiLCJyZXNwb25zZSIsImFycmF5QnVmZmVyIiwiX3dldCIsIndldG5lc3MiLCJfYnVmZmVyIiwiZGVjb2RlQXVkaW9EYXRhIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLGlCQUFBQyxTQUFBLGlCQUFBQyxPQUNBQSxPQUFBRCxRQUFBRCxJQUNBLG1CQUFBRyxlQUFBQyxJQUNBRCxPQUFBLGFBQUFILEdBQ0EsaUJBQUFDLFFBQ0FBLFFBQUEsUUFBQUQsSUFFQUQsRUFBQSxRQUFBQyxJQVJBLENBU0Msb0JBQUFLLFVBQUFDLEtBQUEsV0FDRCxtQkNUQSxJQUFBQyxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFSLFFBR0EsSUFBQUMsRUFBQUssRUFBQUUsR0FBQSxDQUNBQyxFQUFBRCxFQUNBRSxHQUFBLEVBQ0FWLFFBQUEsSUFVQSxPQU5BVyxFQUFBSCxHQUFBSSxLQUFBWCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBTyxHQUdBTixFQUFBUyxHQUFBLEVBR0FULEVBQUFELFFBMERBLE9BckRBTyxFQUFBTSxFQUFBRixFQUdBSixFQUFBTyxFQUFBUixFQUdBQyxFQUFBUSxFQUFBLFNBQUFmLEVBQUFnQixFQUFBQyxHQUNBVixFQUFBVyxFQUFBbEIsRUFBQWdCLElBQ0FHLE9BQUFDLGVBQUFwQixFQUFBZ0IsRUFBQSxDQUEwQ0ssWUFB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LEVBQU0sQ0FDakJFLE9BQVEsUUFDUG5DLEtBQUssU0FBQ29DLEdBQ1AsT0FBT0EsRUFBU0MsNENBU2xCLE9BQU9sSSxLQUFLbUksbUJBT05DLEdBRU5wSSxLQUFLbUksS0FBT25CLFdBQVdvQixHQUd2QnBJLEtBQUtrRCxNQUFNeUUsWUFBWVYsS0FBSzVGLE1BQVFyQixLQUFLbUksbUNBUXpDLE9BQU9uSSxLQUFLNkcscUJBT0pGLEdBRVIzRyxLQUFLNkcsT0FBU0csV0FBV0wsR0FHekIzRyxLQUFLa0QsTUFBTTBFLGNBQWNYLEtBQUs1RixNQUFRckIsS0FBSzZHLHNDQVEzQyxPQUFPN0csS0FBS3FJLHNCQU9IZixHQUFRLElBQUF0QyxFQUFBaEYsS0FDakJBLEtBQUtxQyxhQUFhaUcsZ0JBQWdCaEIsRUFBUSxTQUFDQSxHQUV6Q3RDLEVBQUtxRCxRQUFVZixFQUdmdEMsRUFBSzlCLE1BQU11RSxjQUFjSCxPQUFTdEMsRUFBS3FEIiwiZmlsZSI6Im5vaXNlZnkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJub2lzZWZ5XCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIm5vaXNlZnlcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wibm9pc2VmeVwiXSA9IGZhY3RvcnkoKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMyk7XG4iLCIvKipcbiAqIFRoZSBiYXNpYyBhdWRpbyBub2RlIGNsYXNzLlxuICogVGhpcyBpcyBkZSBza2VsZXRvbiBmb3IgYSBhdWRpbyAgZWZmZWN0LlxuICogV2hlbiB0aGUgZWZmZWN0IG9ubHkgY29udGFpbnMgMSBhdWRpb05vZGUgdGhpcyBjbGFzcyBjYW4gYmUgdXNlZC5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2luZ2xlQXVkaW9Ob2RlIHtcbiAgLy8gbm9kZXMgPSB7fTsgLy97W2tleTogc3RyaW5nXTogQXVkaW9Ob2RlfEdhaW5Ob2RlfERlbGF5Tm9kZXxXYXZlU2hhcGVyTm9kZXxCaXF1YWRGaWx0ZXJOb2RlfE9zY2lsbGF0b3JOb2RlfENvbnZvbHZlck5vZGV9ID0ge307XG5cbiAgY29uc3RydWN0b3IoYXVkaW9Db250ZXh0KSB7XG4gICAgLy8gU2V0IHRoZSBhdWRpby1jb250ZXh0LlxuICAgIHRoaXMuX2F1ZGlvQ29udGV4dCA9IGF1ZGlvQ29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgZWZmZWN0cyBBdWRpb0NvbnRleHQgZ2V0dGVyLlxuICAgKiBAcmV0dXJuIHtBdWRpb0NvbnRleHR9IFRoZSBBdWRpb0NvbnRleHQgdXNlZCBieSB0aGUgZWZmZWN0LlxuICAgKi9cbiAgZ2V0IGF1ZGlvQ29udGV4dCgpIHtcbiAgICByZXR1cm4gdGhpcy5fYXVkaW9Db250ZXh0O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBlZmZlY3RzIEF1ZGlvQ29udGV4dCBzZXR0ZXIuXG4gICAqIEBwYXJhbSAge0F1ZGlvQ29udGV4dH0gYXVkaW9Db250ZXh0XG4gICAqL1xuICBzZXQgYXVkaW9Db250ZXh0KGF1ZGlvQ29udGV4dCkge1xuICAgIHRoaXMuX2F1ZGlvQ29udGV4dCA9IGF1ZGlvQ29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgZWZmZWN0J3MgYXVkaW8tbm9kZSBnZXR0ZXIuXG4gICAqIEByZXR1cm4ge0F1ZGlvTm9kZX0gVGhlIGF1ZGlvLW5vZGUgdXNlZCBmb3IgdGhlIGVmZmVjdC5cbiAgICovXG4gIGdldCBub2RlKCkge1xuICAgIHJldHVybiB0aGlzLl9ub2RlO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBlZmZlY3QncyBhdWRpby1ub2RlIHNldHRlci5cbiAgICogQHBhcmFtICB7QXVkaW9Ob2RlfSBub2RlXG4gICAqL1xuICBzZXQgbm9kZShub2RlKSB7XG4gICAgdGhpcy5fbm9kZSA9IG5vZGU7XG4gIH1cblxuICAvKipcbiAgICogQ29ubmVjdCB0aGUgZWZmZWN0IHRvIG90aGVyIGVmZmVjdHMgb3IgbmF0aXZlIGF1ZGlvLW5vZGVzLlxuICAgKiBAcGFyYW0gIHtBdWRpb05vZGV8U2luZ2xlQXVkaW9Ob2RlfSBub2RlXG4gICAqIEByZXR1cm4ge0F1ZGlvTm9kZXxTaW5nbGVBdWRpb05vZGV9XG4gICAqL1xuICBjb25uZWN0KG5vZGUpIHtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNpbmdsZUF1ZGlvTm9kZSkge1xuICAgICAgdGhpcy5ub2RlLmNvbm5lY3Qobm9kZS5ub2RlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ub2RlLmNvbm5lY3Qobm9kZSk7XG4gICAgfVxuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgLyoqXG4gICAqIGRpc2Nvbm5lY3QgdGhlIGVmZmVjdC5cbiAgICogQHJldHVybiB7QXVkaW9Ob2RlfVxuICAgKi9cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLm5vZGUuZGlzY29ubmVjdCgpO1xuICAgIHJldHVybiB0aGlzLm5vZGU7XG4gIH1cblxuICAvKipcbiAgICogQWxpYXMgZm9yIHRoZSBkaXNjb25uZWN0IG1ldGhvZCwgdG8gb2ZmZXIgdGhlIHNhbWUgYXBpIGFzIGEgTXVsdGlBdWRpb05vZGUuXG4gICAqIEByZXR1cm4ge0F1ZGlvTm9kZX1cbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzY29ubmVjdCgpO1xuICB9XG59XG4iLCJcbmltcG9ydCBTaW5nbGVBdWRpb05vZGUgZnJvbSAnLi9TaW5nbGVBdWRpb05vZGUnO1xuXG4vKipcbiAqIFRoZSBtdWx0aS1hdWRpby1ub2RlIGNsYXNzLlxuICogV2hlbiBjcmVhdGluZyBhbiBlZmZlY3QgZXhpc3Rpbmcgb3V0IG9mIG11bHRpcGxlIGF1ZGlvLW5vZGVzLCB3ZSBjYW4gd3JhcCBpdCBpbiB0aGlzIGNsYXNzLlxuICogWW91IGNhbiBzZXQgdGhlIGlucHV0IG5vZGUgKGVmZmVjdC5ub2RlKSBhbmQgdGhlIG91dHB1dCBub2RlIG9mIHRoZSBlZmZlY3QgKGVmZmVjdC5vdXRwdXQpLlxuICogVGhlIGlucHV0IG5vZGUgaXMgdGhlIGZpcnN0IGF1ZGlvLW5vZGUgaW4gdGhlIGVmZmVjdCwgdGhlIHByZXZpb3VzIGVmZmVjdCB3aWxsIGJlIGNvbm5lY3RlZCB0byB0aGlzIG5vZGUuXG4gKiBUaGUgb3V0cHV0IG5vZGUgaXMgdGhlIGxhc3QgYXVkaW8tbm9kZSBpbiB0aGUgZWZmZWN0LCB0aGUgbmV4dCBlZmZlY3Qgd2lsbCBiZSBjb25uZWN0ZWQgdG8gdGhpcyBub2RlLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUF1ZGlvTm9kZSBleHRlbmRzIFNpbmdsZUF1ZGlvTm9kZSB7XG4gIC8vIGNvbnN0cnVjdG9yKGF1ZGlvQ29udGV4dCkge1xuICAvLyAgIHN1cGVyKGF1ZGlvQ29udGV4dCk7XG4gIC8vIH1cblxuICAvKipcbiAgICAgKiBHZXR0ZXIgZm9yIHRoZSBlZmZlY3RzIG91dHB1dCBub2RlLlxuICAgICAqIEByZXR1cm4ge0F1ZGlvTm9kZX1cbiAgICAgKi9cbiAgZ2V0IG91dHB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5fb3V0cHV0Tm9kZTtcbiAgfVxuXG4gIHNldCBvdXRwdXQob3V0cHV0KSB7XG4gICAgdGhpcy5fb3V0cHV0Tm9kZSA9IG91dHB1dDtcbiAgfVxuXG4gIC8qKlxuICAgICAqIENvbm5lY3QgdGhlIGVmZmVjdCB0byBvdGhlciBlZmZlY3RzIG9yIG5hdGl2ZSBhdWRpby1ub2Rlcy5cbiAgICAgKiBAcGFyYW0gIHtBdWRpb05vZGV8U2luZ2xlQXVkaW9Ob2RlfE11bHRpQXVkaW9Ob2RlfSBub2RlXG4gICAgICogQHJldHVybiB7QXVkaW9Ob2RlfFNpbmdsZUF1ZGlvTm9kZXxNdWx0aUF1ZGlvTm9kZX1cbiAgICAgKi9cbiAgY29ubmVjdChub2RlKSB7XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBTaW5nbGVBdWRpb05vZGUgfHwgbm9kZSBpbnN0YW5jZW9mIE11bHRpQXVkaW9Ob2RlKSB7XG4gICAgICB0aGlzLm5vZGUuY29ubmVjdChub2RlLm5vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5vZGUuY29ubmVjdChub2RlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICAvKipcbiAgICAgKiBEaXNjb25uZWN0IHRoZSBlZmZlY3QuXG4gICAgICogQHJldHVybiB7QXVkaW9Ob2RlfVxuICAgICAqL1xuICBkaXNjb25uZWN0KCkge1xuICAgIHRoaXMub3V0cHV0LmRpc2Nvbm5lY3QoKTtcbiAgICByZXR1cm4gdGhpcy5vdXRwdXQ7XG4gIH1cblxuICAvKipcbiAgICAgKiBEZXN0cm95IGFuIGVmZmVjdC5cbiAgICAgKiBAcmV0dXJuIHtBdWRpb05vZGV9XG4gICAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgT2JqZWN0LmtleXModGhpcy5ub2RlcykuZm9yRWFjaCgobm9kZSk9PiB7XG4gICAgICBpZiAodGhpcy5ub2Rlc1tub2RlXS5kaXNjb25uZWN0ICYmIHR5cGVvZiB0aGlzLm5vZGVzW25vZGVdLmRpc2Nvbm5lY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5ub2Rlc1tub2RlXS5kaXNjb25uZWN0KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5kaXNjb25uZWN0KCk7XG4gIH1cbn1cbiIsImxldCB3aW4gPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IGdsb2JhbDtcbi8qKlxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgYnJvd3NlciBzdXBwb3J0cyBnZXRVc2VyTWVkaWEuXG4gKi9cbmNvbnN0IGdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgfHxcbiAgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSB8fFxuICBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhIHx8XG4gIG5hdmlnYXRvci5tc0dldFVzZXJNZWRpYTtcblxuY29uc3QgaGFzR2V0VXNlck1lZGlhID0gISFnZXRVc2VyTWVkaWE7XG4vKipcbiAqIENoZWNrIGlmIHRoZSBjdXJyZW50IGJyb3dzZXIgc3VwcG9ydHMgdGhlIHdlYi1hdWRpby1hcGkgLlxuICovXG5cbmNvbnN0IGF1ZGlvQ29udGV4dCA9IHdpbi5BdWRpb0NvbnRleHQgfHxcbiAgd2luLndlYmtpdEF1ZGlvQ29udGV4dCB8fFxuICB3aW4ubW96QXVkaW9Db250ZXh0IHx8XG4gIHdpbi5tc0F1ZGlvQ29udGV4dDtcblxuY29uc3QgaGFzQXVkaW9Db250ZXh0ID0gISFhdWRpb0NvbnRleHQ7XG5cbmV4cG9ydCB7XG4gIGhhc0dldFVzZXJNZWRpYSxcbiAgaGFzQXVkaW9Db250ZXh0LFxufTtcbiIsIlxuaW1wb3J0IElucHV0IGZyb20gJy4vYXVkaW8tbm9kZXMvZWZmZWN0cy9JbnB1dCc7XG5pbXBvcnQgT3V0cHV0IGZyb20gJy4vYXVkaW8tbm9kZXMvZWZmZWN0cy9PdXRwdXQnO1xuaW1wb3J0IFZvbHVtZSBmcm9tICcuL2F1ZGlvLW5vZGVzL2VmZmVjdHMvVm9sdW1lJztcbmltcG9ydCBSZXZlcmIgZnJvbSAnLi9hdWRpby1ub2Rlcy9lZmZlY3RzL1JldmVyYic7XG5pbXBvcnQge2hhc0F1ZGlvQ29udGV4dCwgaGFzR2V0VXNlck1lZGlhfSBmcm9tICcuL1V0aWwnO1xuXG5leHBvcnQge1xuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBWb2x1bWUsXG4gIFJldmVyYixcbiAgaGFzQXVkaW9Db250ZXh0LFxuICBoYXNHZXRVc2VyTWVkaWEsXG59O1xuIiwiXG5pbXBvcnQgU2luZ2xlQXVkaW9Ob2RlIGZyb20gJy4uL1NpbmdsZUF1ZGlvTm9kZSc7XG5pbXBvcnQgTXVsdGlBdWRpb05vZGUgZnJvbSAnLi4vTXVsdGlBdWRpb05vZGUnO1xuaW1wb3J0IHtoYXNHZXRVc2VyTWVkaWF9IGZyb20gJy4uLy4uL1V0aWwnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dCBleHRlbmRzIFNpbmdsZUF1ZGlvTm9kZSB7XG4gIGNvbnN0cnVjdG9yKGF1ZGlvQ29udGV4dCkge1xuICAgIHN1cGVyKGF1ZGlvQ29udGV4dCk7XG4gICAgdGhpcy5fZGVmZXJyZWRDb25uZWN0cyA9IFtdO1xuICAgIHRoaXMuX2hhc1Blcm1pc3Npb25zID0gZmFsc2U7XG4gIH1cblxuICBnZXQgaW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMubm9kZTtcbiAgfVxuICBzZXQgaW5wdXQoc3RyZWFtKSB7XG4gICAgLy8gQ3JlYXRlIGEgbWVkaWEtc3RyZWFtIHNvdXJjZS5cbiAgICB0aGlzLm5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuICB9XG4gIC8qKlxuICAgICAqIEdldCB5b3VyIG1pY3JvcGhvbmUgc291bmQgYXMgaW5wdXQuXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxBdWRpb05vZGU+fSBSZXNvbHZlcyB3aGVuIHlvdSBhY2NlcHQgdG8gdXNlIHRoZSBtaWNyb3Bob25lLlxuICAgICAqL1xuICBnZXRVc2VyTWVkaWEoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT4ge1xuICAgICAgaWYgKGhhc0dldFVzZXJNZWRpYSkge1xuICAgICAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHtcbiAgICAgICAgICBhdWRpbzogdHJ1ZSxcbiAgICAgICAgfSwgKHN0cmVhbSk9PiB7XG4gICAgICAgICAgdGhpcy5pbnB1dCA9IHN0cmVhbTtcbiAgICAgICAgICB0aGlzLl9oYXNQZXJtaXNzaW9ucyA9IHRydWU7XG5cbiAgICAgICAgICAvLyBDb25uZWN0IHRoZSBkZWZmZXJlZCBjb25uZWN0c1xuICAgICAgICAgIHRoaXMuX2RlZmVycmVkQ29ubmVjdHMuZm9yRWFjaCgobm9kZSk9PiB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Qobm9kZSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXNvbHZlKHN0cmVhbSk7XG4gICAgICAgIH0sIChlcnJvcik9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWplY3QoRXJyb3IoJ1lvdXIgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSB1c2Ugb2YgdXNlci1tZWRpYSwgcGxlYXNlIHVwZ3JhZGUgb3IgdXNlIGFub3RoZXIgYnJvd3NlciEnKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAgICogQ29ubmVjdCB0aGUgZWZmZWN0IHRvIG90aGVyIGVmZmVjdHMgb3IgbmF0aXZlIGF1ZGlvLW5vZGVzLlxuICAgICAqIEBwYXJhbSAge0F1ZGlvTm9kZXxTaW5nbGVBdWRpb05vZGV8TXVsdGlBdWRpb05vZGV9IG5vZGVcbiAgICAgKiBAcmV0dXJuIHtBdWRpb05vZGV8U2luZ2xlQXVkaW9Ob2RlfE11bHRpQXVkaW9Ob2RlfVxuICAgICAqL1xuICBjb25uZWN0KG5vZGUpIHtcbiAgICAvLyBJZiB0aGVyZSBpcyBubyBpbnB1dCBub2RlIHlldCwgY29ubmVjdCB3aGVuIHRoZXJlIGlzIGEgbm9kZVxuICAgIGlmICh0eXBlb2YgdGhpcy5ub2RlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5fZGVmZXJyZWRDb25uZWN0cy5wdXNoKG5vZGUpO1xuXG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG5cbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNpbmdsZUF1ZGlvTm9kZSB8fCBub2RlIGluc3RhbmNlb2YgTXVsdGlBdWRpb05vZGUpIHtcbiAgICAgIHRoaXMubm9kZS5jb25uZWN0KG5vZGUubm9kZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubm9kZS5jb25uZWN0KG5vZGUpO1xuICAgIH1cblxuICAgIHRoaXMubm9kZS5jb25uZWN0KG5vZGUpO1xuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICAvLyBHZXQgYSBsaXN0IG9mIGF1ZGlvIGluLWFuZC1vdXRwdXQgZGV2aWNlcyBkZXZpY2VzLlxuICAvLyBAcmV0dXJuIEEgbGlzdCBvZiB0aGUgYXZhaWxhYmxlIGF1ZGlvIGluLWFuZC1vdXRwdXQgZGV2aWNlcy5cbiAgZ2V0QXVkaW9EZXZpY2VzKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+IHtcbiAgICAgIGlmICh0aGlzLl9oYXNQZXJtaXNzaW9ucykge1xuICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMoKS50aGVuKChkZXZpY2VzKT0+IHtcbiAgICAgICAgICByZXNvbHZlKGRldmljZXMuZmlsdGVyKChkZXZpY2UpPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRldmljZS5raW5kICYmIGRldmljZS5raW5kID09PSAnYXVkaW9pbnB1dCc7XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpPT4ge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5nZXRVc2VyTWVkaWEoKS50aGVuKCgpPT4ge1xuICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oKGRldmljZXMpPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLmZpbHRlcigoZGV2aWNlKT0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIGRldmljZS5raW5kICYmIGRldmljZS5raW5kID09PSAnYXVkaW9pbnB1dCc7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSkuY2F0Y2goKGVycm9yKT0+IHtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pLmNhdGNoKChlcnJvcik9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiIsImltcG9ydCBTaW5nbGVBdWRpb05vZGUgZnJvbSAnLi4vU2luZ2xlQXVkaW9Ob2RlJztcblxuLyoqXG4gKiBUaGUgYXVkaW8tZWZmZWN0cyBvdXRwdXQgY2xhc3MuXG4gKiBUaGlzIGNsYXNzIGNvbm5lY3RzIHRvIHlvdXIgZGV2aWNlJ3MgYXVkaW8gb3V0cHV0LlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPdXRwdXQgZXh0ZW5kcyBTaW5nbGVBdWRpb05vZGUge1xuICBjb25zdHJ1Y3RvcihhdWRpb0NvbnRleHQpIHtcbiAgICBzdXBlcihhdWRpb0NvbnRleHQpO1xuXG4gICAgaWYgKHRoaXMuYXVkaW9Db250ZXh0KSB7XG4gICAgICB0aGlzLm5vZGUgPSBhdWRpb0NvbnRleHQuZGVzdGluYXRpb247XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgU2luZ2xlQXVkaW9Ob2RlIGZyb20gJy4uL1NpbmdsZUF1ZGlvTm9kZSc7XG5cbi8qKlxuICogVGhlIGF1ZGlvLWVmZmVjdHMgdm9sdW1lIGNsYXNzLlxuICogVGhpcyBjbGFzcyBsZXRzIHlvdSBjaGFuZ2UgdGhlIHZvbHVtZSBvZiB0aGUgYXVkaW8gc2lnbmFsLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWb2x1bWUgZXh0ZW5kcyBTaW5nbGVBdWRpb05vZGUge1xuICBjb25zdHJ1Y3RvcihhdWRpb0NvbnRleHQpIHtcbiAgICBzdXBlcihhdWRpb0NvbnRleHQpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBnYWluLW5vZGUgd2hpY2ggd2UnbGwgdXNlIHRvIGNoYW5nZSB0aGUgdm9sdW1lLlxuICAgIHRoaXMubm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgIC8vIFRoZSBpbml0aWFsIHZvbHVtZSBsZXZlbCBpcyAxMDAlLlxuICAgIHRoaXMubGV2ZWwgPSAxO1xuXG4gICAgLy8gVGhlIGVmZmVjdCBpcyBub3QgbXV0ZWQgYnkgZGVmYXVsdC5cbiAgICB0aGlzLm11dGUgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgICAqIEdldHRlciBmb3IgdGhlIGVmZmVjdHMgdm9sdW1lLlxuICAgICAqIEByZXR1cm4ge0Zsb2F0fVxuICAgICAqL1xuICBnZXQgbGV2ZWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xldmVsO1xuICB9XG5cbiAgLyoqXG4gICAgICogU2V0dGVyIGZvciB0aGUgZWZmZWN0cyB2b2x1bWUuXG4gICAgICogQHBhcmFtICB7RmxvYXR9IHZvbHVtZSBUaGUgdm9sdW1lLCB0aXBpY2FsIGJldHdlZW4gMCBhbmQgMS5cbiAgICAgKi9cbiAgc2V0IGxldmVsKHZvbHVtZSkge1xuICAgIC8vIFBhcnNlIHRoZSB2b2x1bWUsIGl0IGNhbiBub3QgYmUgbG93ZXIgdGhhbiAwLlxuICAgIGxldCB2b2wgPSBwYXJzZUZsb2F0KHZvbHVtZSk7XG5cbiAgICB2b2wgPSAodm9sID49IDAgPyB2b2wgOiAwKTtcblxuICAgIC8vIFNldCB0aGUgaW50ZXJuYWwgdm9sdW1lIHZhbHVlLlxuICAgIHRoaXMuX2xldmVsID0gdm9sO1xuXG4gICAgLy8gU2V0IHRoZSBnYWluTm9kZSdzIGdhaW4gdmFsdWUuXG4gICAgdGhpcy5ub2RlLmdhaW4udmFsdWUgPSB2b2w7XG5cbiAgICAvLyBTZXQgdGhlIGludGVybmFsIG11dGUgdmFsdWUuXG4gICAgdGhpcy5fbXV0ZSA9ICh2b2wgPT09IDApO1xuICB9XG5cbiAgLyoqXG4gICAgICogR2V0dGVyIGZvciB0aGUgZWZmY3RzIG11dGUgZnVuY3Rpb25hbGl0eS5cbiAgICAgKiBAcmV0dXJuIHtbdHlwZV19IFtkZXNjcmlwdGlvbl1cbiAgICAgKi9cbiAgZ2V0IG11dGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX211dGU7XG4gIH1cblxuICAvKipcbiAgICAgKiBTZXR0ZXIgZm9yIHRoZSBlZmZlY3RzIG11dGUgZnVuY3Rpb25hbGl0eS5cbiAgICAgKiBAcGFyYW0gIHtCb29sZWFufSBtdXRlIFdoZXRoZXIgdGhlIGVmZmVjdCBpcyBtdXRlZC5cbiAgICAgKi9cbiAgc2V0IG11dGUobXV0ZSkge1xuICAgIC8vIFNldCB0aGUgaW50ZXJuYWwgbXV0ZSB2YWx1ZS5cbiAgICB0aGlzLl9tdXRlID0gISFtdXRlO1xuXG4gICAgaWYgKHRoaXMuX211dGUpIHtcbiAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHZvbHVtZSBiZWZvcmUgbXV0aW5nXG4gICAgICB0aGlzLl9sZXZlbEJlZm9yZU11dGUgPSB0aGlzLmxldmVsO1xuXG4gICAgICAvLyBTZXQgdGhlIHZvbHVtZSB0byAwXG4gICAgICB0aGlzLmxldmVsID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2V0IHRoZSB2b2x1bWUgdG8gdGhlIHByZXZpb3VzIHZvbHVtZS5cbiAgICAgIHRoaXMubGV2ZWwgPSB0aGlzLl9sZXZlbEJlZm9yZU11dGUgfHwgdGhpcy5fbGV2ZWw7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgTXVsdGlBdWRpb05vZGUgZnJvbSAnLi4vTXVsdGlBdWRpb05vZGUnO1xuXG4vKipcbiAqIFRoZSBhdWRpby1lZmZlY3RzIHJldmVyYiBjbGFzcy5cbiAqIFRoaXMgY2xhc3MgbGV0cyB5b3UgYWRkIGEgcmV2ZXJiIGVmZmVjdC5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmV2ZXJiIGV4dGVuZHMgTXVsdGlBdWRpb05vZGUge1xuICAvLyBfd2V0O1xuICAvLyBfbGV2ZWw7XG4gIC8vIF9idWZmZXI7XG5cbiAgY29uc3RydWN0b3IoYXVkaW9Db250ZXh0LCBidWZmZXIpIHtcbiAgICBzdXBlcihhdWRpb0NvbnRleHQpO1xuXG4gICAgdGhpcy5ub2RlcyA9IHtcbiAgICAgIGlucHV0R2Fpbk5vZGU6IGF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCksIC8vIENyZWF0ZSB0aGUgaW5wdXQgYW5kIG91dHB1dCBnYWluLW5vZGVcbiAgICAgIG91dHB1dEdhaW5Ob2RlOiBhdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpLFxuICAgICAgY29udm9sdmVyTm9kZTogYXVkaW9Db250ZXh0LmNyZWF0ZUNvbnZvbHZlcigpLCAvLyBDcmVhdGUgdGhlIGNvbnZvbHZlciBub2RlIHRvIGNyZWF0ZSB0aGUgcmV2ZXJiIGVmZmVjdFxuICAgICAgd2V0R2Fpbk5vZGU6IGF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCksIC8vIENyZWF0ZSB0aGUgd2V0bmVzcyBjb250cm9sbCBnYWluLW5vZGVcbiAgICAgIGxldmVsR2Fpbk5vZGU6IGF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCksIC8vIENyZWF0ZSB0aGUgbGV2ZWwgY29udHJvbGwgZ2Fpbi1ub2RlXG4gICAgfTtcblxuICAgIC8vIFdpcmUgaXQgYWxsIHVwXG4gICAgdGhpcy5ub2Rlcy5pbnB1dEdhaW5Ob2RlLmNvbm5lY3QodGhpcy5ub2Rlcy5jb252b2x2ZXJOb2RlKTtcbiAgICB0aGlzLm5vZGVzLmlucHV0R2Fpbk5vZGUuY29ubmVjdCh0aGlzLm5vZGVzLndldEdhaW5Ob2RlKTtcbiAgICB0aGlzLm5vZGVzLmNvbnZvbHZlck5vZGUuY29ubmVjdCh0aGlzLm5vZGVzLmxldmVsR2Fpbk5vZGUpO1xuICAgIHRoaXMubm9kZXMubGV2ZWxHYWluTm9kZS5jb25uZWN0KHRoaXMubm9kZXMub3V0cHV0R2Fpbk5vZGUpO1xuICAgIHRoaXMubm9kZXMud2V0R2Fpbk5vZGUuY29ubmVjdCh0aGlzLm5vZGVzLm91dHB1dEdhaW5Ob2RlKTtcblxuICAgIC8vIFNldCB0aGUgaW5wdXQgZ2Fpbi1ub2RlIGFzIHRoZSBpbnB1dC1ub2RlLlxuICAgIHRoaXMubm9kZSA9IHRoaXMubm9kZXMuaW5wdXRHYWluTm9kZTtcblxuICAgIC8vIFNldCB0aGUgb3V0cHV0IGdhaW4tbm9kZSBhcyB0aGUgb3V0cHV0LW5vZGUuXG4gICAgdGhpcy5vdXRwdXQgPSB0aGlzLm5vZGVzLm91dHB1dEdhaW5Ob2RlO1xuXG4gICAgLy8gU2V0IHRoZSBkZWZhdWx0IHdldG5lc3MgdG8gMC41XG4gICAgdGhpcy53ZXQgPSAwLjU7XG5cbiAgICAvLyBTZXQgdGhlIGRlZmF1bHQgbGV2ZWwgdG8gMVxuICAgIHRoaXMubGV2ZWwgPSAxO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgc3RhbmRhcmQgaW5wdXQgcmVzcG9uc2VmaWxlLlxuICAgKiBAcGFyYW0ge0FueX0gZmlsZVxuICAgKiBAcmV0dXJuIHtQcm9taXNlPEF1ZGlvQnVmZmVyPn1cbiAgICovXG4gIGdldElucHV0UmVzcG9uc2VGaWxlKGZpbGUpIHtcbiAgICByZXR1cm4gZmV0Y2goZmlsZSwge1xuICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICB9KS50aGVuKChyZXNwb25zZSk9PiB7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXR0ZXIgZm9yIHRoZSBlZmZlY3QncyB3ZXRuZXNzXG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICovXG4gIGdldCB3ZXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3dldDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR0ZXIgZm9yIHRoZSBlZmZlY3QncyB3ZXRuZXNzXG4gICAqIEBwYXJhbSAge251bWJlcn0gd2V0bmVzc1xuICAgKi9cbiAgc2V0IHdldCh3ZXRuZXNzKSB7XG4gICAgLy8gU2V0IHRoZSBpbnRlcm5hbCB3ZXRuZXNzIHZhbHVlXG4gICAgdGhpcy5fd2V0ID0gcGFyc2VGbG9hdCh3ZXRuZXNzKTtcblxuICAgIC8vIFNldCB0aGUgbmV3IHZhbHVlIGZvciB0aGUgd2V0bmVzcyBjb250cm9sbCBnYWluLW5vZGVcbiAgICB0aGlzLm5vZGVzLndldEdhaW5Ob2RlLmdhaW4udmFsdWUgPSB0aGlzLl93ZXQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0dGVyIGZvciB0aGUgZWZmZWN0J3MgbGV2ZWxcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0IGxldmVsKCkge1xuICAgIHJldHVybiB0aGlzLl9sZXZlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR0ZXIgZm9yIHRoZSBlZmZlY3QncyBsZXZlbFxuICAgKiBAcGFyYW0gIHtudW1iZXJ9IGxldmVsXG4gICAqL1xuICBzZXQgbGV2ZWwobGV2ZWwpIHtcbiAgICAvLyBTZXQgdGhlIGludGVybmFsIGxldmVsIHZhbHVlXG4gICAgdGhpcy5fbGV2ZWwgPSBwYXJzZUZsb2F0KGxldmVsKTtcblxuICAgIC8vIFNldCB0aGUgZGVsYXlUaW1lIHZhbHVlIG9mIHRoZSBkZWxheS1ub2RlXG4gICAgdGhpcy5ub2Rlcy5sZXZlbEdhaW5Ob2RlLmdhaW4udmFsdWUgPSB0aGlzLl9sZXZlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXR0ZXIgZm9yIHRoZSBlZmZlY3QncyBjb252b2x2ZXIgYnVmZmVyXG4gICAqIEByZXR1cm4ge0J1ZmZlcn1cbiAgICovXG4gIGdldCBidWZmZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2J1ZmZlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR0ZXIgZm9yIHRoZSBlZmZlY3QncyBjb252b2x2ZXIgYnVmZmVyXG4gICAqIEBwYXJhbSAge1N0cmVhbX0gYnVmZmVyXG4gICAqL1xuICBzZXQgYnVmZmVyKGJ1ZmZlcikge1xuICAgIHRoaXMuYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShidWZmZXIsIChidWZmZXIpPT4ge1xuICAgICAgLy8gU2V0IHRoZSBpbnRlcm5hbCBidWZmZXIgdmFsdWVcbiAgICAgIHRoaXMuX2J1ZmZlciA9IGJ1ZmZlcjtcblxuICAgICAgLy8gU2V0IHRoZSBidWZmZXIgZ2Fpbi1ub2RlIHZhbHVlXG4gICAgICB0aGlzLm5vZGVzLmNvbnZvbHZlck5vZGUuYnVmZmVyID0gdGhpcy5fYnVmZmVyO1xuICAgIH0pO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9